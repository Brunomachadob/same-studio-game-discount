{"version":3,"sources":["models/Rule.ts","data/mock.ts","components/GameCard.tsx","components/Library.tsx","components/Store.tsx","components/Rules.tsx","business/RuleDescriptionEvaluator.ts","business/RuleMatcher.ts","business/DiscountCalculator.ts","App.tsx","index.tsx"],"names":["RuleType","ALL_GAMES","id","name","price","studioId","franchise","tags","prequelId","RULES","type","SAME_STUDIO","percentage","maxPercentage","CONTAINS_TAG","options","SEQUEL","useStyles","makeStyles","theme","createStyles","root","margin","spacing","minWidth","minHeight","studio","fontSize","color","palette","info","light","useStylesPriceWithDiscount","oldPrice","discountInfo","verticalAlign","currencyFormat","Intl","NumberFormat","style","currency","Price","className","Typography","format","PriceWithDiscount","classes","Tooltip","title","GameCard","priceButton","game","onBuyGame","onRemoveGame","Card","key","elevation","CardContent","variant","component","map","tag","join","CardActions","Button","size","onClick","gameContainer","display","flexWrap","Library","games","Paper","Store","rulesContainer","rule","Rules","rules","SAME_FRANCHISE","evaluateRuleDescription","countMatches","storeGame","library","find","reduce","currentMatches","libraryGame","ruleType","gameA","gameB","sameStudio","findIndex","gameTag","includes","containsTag","calculateDiscountInfo","discountInfos","matchCount","Math","min","matches","tagOptions","evaluateDiscountDescription","filter","sort","a","b","length","undefined","flexGrow","padding","App","useState","storeGames","setStoreGames","libraryGames","setLibraryGames","useEffect","libraryGameIds","storeGamesWithDiscount","AppBar","position","Toolbar","IconButton","edge","aria-label","target","href","libGames","concat","libGame","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.eaa3bf96.chunk.js","sourcesContent":["export enum RuleType {\n    SAME_STUDIO,\n    SAME_FRANCHISE,\n    SEQUEL,\n    CONTAINS_TAG,\n};\n\nexport interface Rule {\n    id: string;\n    studioId: string;\n    type: RuleType;\n    percentage: number;\n    maxPercentage: number;\n    options?: ContainsTagOption\n};\n\nexport interface ContainsTagOption {\n    tags: string[];\n};","import { Game } from '../models/Game';\nimport { Rule, RuleType } from '../models/Rule';\n\nconst BETHESDA = 'Bethesda';\nconst SANTA_MONICA = 'Santa Monica';\n\nexport const ALL_GAMES: Game[] = [\n    { id: '1', name: 'God of War', price: 10, studioId: SANTA_MONICA, franchise: 'gow', tags: ['rpg'] },\n    { id: '2', name: 'God of War 2', price: 10.5, studioId: SANTA_MONICA, franchise: 'gow', prequelId: '1', tags: ['rpg', 'open-world'] },\n    { id: '3', name: 'God of War 3', price: 20, studioId: SANTA_MONICA, franchise: 'gow', prequelId: '2', tags: ['rpg', 'open-world'] },\n\n    { id: '4', name: 'Elder Scrolls', price: 40, studioId: BETHESDA, franchise: 'elder-scrolls', tags: ['rpg', 'open-world'] },\n    { id: '5', name: 'Elder Scrolls 2', price: 50, studioId: BETHESDA, franchise: 'elder-scrolls', prequelId: '4', tags: ['rpg', 'open-world'] },\n    { id: '6', name: 'Elder Scrolls 3', price: 60, studioId: BETHESDA, franchise: 'elder-scrolls', prequelId: '5', tags: ['rpg', 'open-world'] },\n    { id: '7', name: 'Fallout', price: 60, studioId: BETHESDA, franchise: 'fallout', tags: ['rpg', 'open-world'] },\n];\n\nexport const RULES: Rule[] = [\n    { id: '1', type: RuleType.SAME_STUDIO, percentage: 5, maxPercentage: 10, studioId: SANTA_MONICA },\n    { id: '2', type: RuleType.CONTAINS_TAG, percentage: 10, maxPercentage: 20, studioId: BETHESDA, options: { tags: ['open-world'] } },\n    { id: '3', type: RuleType.SEQUEL, percentage: 50, maxPercentage: 50, studioId: BETHESDA },\n];\n","import React from 'react';\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\nimport Button from '@material-ui/core/Button';\nimport Card from '@material-ui/core/Card';\nimport CardActions from '@material-ui/core/CardActions';\nimport CardContent from '@material-ui/core/CardContent';\nimport InfoOutlined from '@material-ui/icons/InfoOutlined';\n\nimport { Game, DiscountInfo } from '../models/Game';\nimport { Tooltip } from '@material-ui/core';\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      margin: theme.spacing(1),\n      minWidth: theme.spacing(20),\n      minHeight: theme.spacing(20),\n    },\n    studio: {\n      fontSize: 14,\n    },\n    tags: {\n      color: theme.palette.info.light\n    },\n  }),\n);\n\nconst useStylesPriceWithDiscount = makeStyles((theme: Theme) =>\n  createStyles({\n    oldPrice: {\n      fontSize: 13,\n    },\n    discountInfo: {\n      fontSize: 15,\n      verticalAlign: 'middle',\n    },\n  }),\n);\n\nconst currencyFormat = new Intl.NumberFormat('de-DE', { style: 'currency', currency: 'EUR' })\n\ninterface Props {\n    game: Game;\n    onRemoveGame?: (game: Game) => void;\n    onBuyGame?: (game: Game) => void;\n}\n\nfunction Price({ price, className }: { price: number, className?: string }) {\n  return (\n    <Typography color=\"textSecondary\" className={className}>\n      {currencyFormat.format(price)}\n    </Typography>\n  );\n}\n\nfunction PriceWithDiscount({ price, discountInfo }: { price: number, discountInfo: DiscountInfo }) {\n  const classes = useStylesPriceWithDiscount();\n\n  return (\n    <div>\n      <s><Price price={price} className={classes.oldPrice}/></s>\n      <Typography color=\"textSecondary\">\n        {currencyFormat.format(discountInfo.price)}\n        { discountInfo ? (\n          <Tooltip title={discountInfo.info}>\n            <InfoOutlined className={classes.discountInfo} />\n          </Tooltip>\n        ) : null }\n    </Typography>\n    </div>\n  );\n}\n\nexport default function GameCard({ game, onBuyGame, onRemoveGame }: Props) {\n  const classes = useStyles();\n\n  let priceButton;\n\n  if (onBuyGame) {\n    priceButton = game.discountInfo ? (\n      <PriceWithDiscount price={game.price} discountInfo={game.discountInfo} />\n    ) : <Price price={game.price}/>\n  }\n\n  return (\n    <Card key={game.id} elevation={3} className={classes.root}>\n      <CardContent>\n        <Typography className={classes.studio} color=\"textSecondary\">\n            {game.studioId}\n        </Typography>\n        <Typography variant=\"h5\" component=\"h2\">\n            {game.name}\n        </Typography>\n        {\n          priceButton\n        }\n        <Typography className={classes.tags}>\n            {game.tags.map((tag) => `#${tag}`).join(' ')}\n        </Typography>\n      </CardContent>\n      <CardActions>\n        {\n          onBuyGame ? \n            <Button size=\"small\" onClick={() => onBuyGame(game)}>Buy</Button>\n            : null\n        }\n        {\n          onRemoveGame ? \n            <Button size=\"small\" onClick={() => onRemoveGame(game)}>Destroy</Button>\n            : null\n        }\n      </CardActions>\n    </Card>\n  );\n}\n","import React from 'react';\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\nimport Paper from '@material-ui/core/Paper';\nimport Typography from '@material-ui/core/Typography';\n\nimport { Game } from '../models/Game';\n\nimport GameCard from './GameCard';\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      \n    },\n    gameContainer: {\n      display: 'flex',\n      flexWrap: 'wrap',\n    },\n  }),\n);\n\ninterface Props {\n    games: Game[];\n    onRemoveGame: (game: Game) => void;\n}\n\nexport default function Library({ games, onRemoveGame }: Props) {\n  const classes = useStyles();\n\n  return (\n    <Paper elevation={0} className={classes.root}>\n      <Typography variant=\"h4\">My Library</Typography>\n      <div className={classes.gameContainer}>\n        {\n            games.map((game: Game) => \n              <GameCard game={game} onRemoveGame={onRemoveGame}/>\n            )\n        }\n      </div>\n    </Paper>\n  );\n}\n","import React from 'react';\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\nimport Paper from '@material-ui/core/Paper';\nimport Typography from '@material-ui/core/Typography';\n\nimport { Game } from '../models/Game';\n\nimport GameCard from './GameCard';\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      \n    },\n    gameContainer: {\n      display: 'flex',\n      flexWrap: 'wrap',\n    },\n  }),\n);\n\ninterface Props {\n    games: Game[];\n    onBuyGame: (game: Game) => void;\n}\n\nexport default function Store({ games, onBuyGame }: Props) {\n  const classes = useStyles();\n\n  return (\n    <Paper elevation={0} className={classes.root}>\n      <Typography variant=\"h4\">Store</Typography>\n      <div className={classes.gameContainer}>\n        {\n            games.map((game: Game) =>\n              <GameCard game={game} onBuyGame={onBuyGame} />\n            )\n        }\n      </div>\n    </Paper>\n  );\n}\n","import React from 'react';\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\nimport Paper from '@material-ui/core/Paper';\nimport Typography from '@material-ui/core/Typography';\nimport Card from '@material-ui/core/Card';\nimport CardContent from '@material-ui/core/CardContent';\n\nimport { Rule } from '../models/Rule';\nimport { evaluateRuleDescription } from '../business/RuleDescriptionEvaluator';\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      \n    },\n    rulesContainer: {\n      display: 'flex',\n      flexWrap: 'wrap',\n    },\n    rule: {\n      margin: theme.spacing(1),\n    }\n  }),\n);\n\ninterface Props {\n    rules: Rule[];\n}\n\nexport default function Rules({ rules }: Props) {\n  const classes = useStyles();\n\n  return (\n    <Paper elevation={0} className={classes.root}>\n      <Typography variant=\"h4\">Discount Rules</Typography>\n      <div className={classes.rulesContainer}>\n        {\n            rules.map((rule: Rule) => \n              <Card key={rule.id} elevation={3} className={classes.rule}>\n                <CardContent>\n                  <Typography color=\"textSecondary\">\n                    {rule.studioId}\n                  </Typography>\n                  <Typography>\n                    {evaluateRuleDescription(rule)}\n                  </Typography>\n                </CardContent>\n              </Card>\n            )\n        }\n      </div>\n    </Paper>\n  );\n}\n","import { RuleType, Rule, ContainsTagOption } from \"../models/Rule\";\n\nexport function evaluateRuleDescription(rule: Rule) {\n    switch(rule.type) {\n        case RuleType.SEQUEL:\n            return `${rule.percentage}% discount if you own the prequel of the game`\n        case RuleType.SAME_STUDIO:\n            return `${rule.percentage}% discount per game of the same studio you own, up to ${rule.maxPercentage}%`;\n        case RuleType.SAME_FRANCHISE:\n            return `${rule.percentage}% discount per game of the same studio and franchise you own, up to ${rule.maxPercentage}%`;\n        case RuleType.CONTAINS_TAG:\n            return `${rule.percentage}% discount per game of the same studio and with tags '${rule.options?.tags?.join(' or ')}' you own, up to ${rule.maxPercentage}%`;\n    }\n}\n\nexport function evaluateDiscountDescription(percentage: number, matches: number, ruleType: RuleType, tagOptions?: ContainsTagOption) {\n    switch(ruleType) {\n        case RuleType.SEQUEL:\n            return `${percentage}% discount because you own the prequel of this game`\n        case RuleType.SAME_STUDIO:\n            return `${percentage}% discount because you own ${matches} games of the same studio`;\n        case RuleType.SAME_FRANCHISE:\n            return `${percentage}% discount because you own ${matches} games of the same franchise`;\n        case RuleType.CONTAINS_TAG:\n            return `${percentage}% discount because you own ${matches} games with the tags '${tagOptions?.tags?.join(' or ')}'`;\n    }\n}\n","import { Game } from \"../models/Game\";\nimport { ContainsTagOption, Rule, RuleType } from \"../models/Rule\";\n\nexport function countMatches(\n    rule: Rule,\n    storeGame: Game,\n    library: Game[]\n): number {\n    if (storeGame.studioId !== rule.studioId) {\n        return 0;\n    }\n\n    if (rule.type === RuleType.SEQUEL) {\n        if (!storeGame.prequelId) {\n            return 0;\n        }\n\n        const prequelGame = library.find((game) => game.id === storeGame.prequelId);\n\n        return prequelGame ? 1 : 0\n    }\n\n    return library.reduce((currentMatches, libraryGame) => {\n        const matchesRule = sameStudio(rule.type, storeGame, libraryGame)\n            || sameFranchise(rule.type, storeGame, libraryGame)\n            || containsTag(rule.type, rule.studioId, libraryGame, rule.options as ContainsTagOption)\n\n        return currentMatches + (matchesRule ? 1 : 0)  \n    }, 0);\n}\n\nfunction sameStudio(ruleType: RuleType, gameA: Game, gameB: Game) {\n    return ruleType === RuleType.SAME_STUDIO && gameA.studioId === gameB.studioId\n}\n\nfunction sameFranchise(ruleType: RuleType, gameA: Game, gameB: Game) {\n    return ruleType === RuleType.SAME_FRANCHISE \n        && sameStudio(RuleType.SAME_STUDIO, gameA, gameB) \n        && gameA.franchise === gameB.franchise;\n}\n\nfunction containsTag(ruleType: RuleType, studioId: string, game: Game, options: ContainsTagOption) {\n    return ruleType === RuleType.CONTAINS_TAG\n        && game.studioId === studioId\n        && game.tags.findIndex((gameTag) => options.tags.includes(gameTag)) > -1;\n}\n","import { Rule } from \"../models/Rule\";\nimport { Game, DiscountInfo } from \"../models/Game\";\nimport { countMatches } from \"./RuleMatcher\";\nimport { evaluateDiscountDescription } from \"./RuleDescriptionEvaluator\";\n\nexport function applyDiscounts(\n    rules: Rule[],\n    store: Game[],\n    library: Game[]\n): Game[] {\n    return store.map((storeGame) => ({\n        ...storeGame,\n        discountInfo: calculateDiscountInfo(rules, storeGame, library)\n    }));\n}\n\nfunction calculateDiscountInfo(\n    rules: Rule[],\n    game: Game,\n    library: Game[]\n): DiscountInfo | undefined {\n    const discountInfos: DiscountInfo[] = rules.map((rule) => {\n        const matchCount = countMatches(rule, game, library) || 0;\n        const percentage = Math.min(matchCount * rule.percentage, rule.maxPercentage);\n        const info = evaluateDiscountDescription(percentage, matchCount, rule.type, rule.options);\n        const price = game.price - (game.price * percentage / 100)\n\n        return { percentage, info, price };\n    })\n    .filter((info) => info.percentage > 0)\n    .sort((a, b) => a.percentage - b.percentage);\n\n    return discountInfos.length ? discountInfos[discountInfos.length - 1] : undefined;\n}\n\n","import React, { useState, useEffect } from 'react';\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\nimport AppBar from '@material-ui/core/AppBar';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Typography from '@material-ui/core/Typography';\nimport GitHubIcon from '@material-ui/icons/GitHub';\nimport { IconButton } from '@material-ui/core';\n\nimport { Game } from './models/Game';\nimport { ALL_GAMES, RULES } from './data/mock';\n\nimport Library from './components/Library';\nimport Store from './components/Store';\nimport Rules from './components/Rules';\n\nimport { applyDiscounts } from './business/DiscountCalculator';\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      flexGrow: 1,\n      padding: theme.spacing(1),\n      '& > *': {\n        margin: theme.spacing(1),\n      }\n    },\n    title: {\n      flexGrow: 1,\n    },\n  }),\n);\n\nexport default function App() {\n  const classes = useStyles();\n\n  const [storeGames, setStoreGames] = useState(ALL_GAMES);\n  const [libraryGames, setLibraryGames] = useState<Game[]>([]);\n\n  useEffect(() => {\n    const libraryGameIds = libraryGames.map((game) => game.id);\n    const storeGames = ALL_GAMES.filter((game: Game) => !libraryGameIds.includes(game.id))\n    const storeGamesWithDiscount = applyDiscounts(RULES, storeGames, libraryGames);\n\n    setStoreGames(storeGamesWithDiscount);\n  }, [libraryGames])\n\n  const onRemoveLibraryGame = (game: Game) => {\n    setLibraryGames((libGames) => libGames.filter((libGame) => libGame.id !== game.id));\n  };\n\n  const onBuyGame = (game: Game) => {\n    setLibraryGames((libGames) => libGames.concat(game));\n  };\n\n  return (\n    <div>\n      <AppBar position=\"static\">\n        <Toolbar>\n          <Typography variant=\"h6\" className={classes.title}>\n            Studio fidelity program\n          </Typography>\n          <IconButton edge=\"start\" color=\"inherit\" aria-label=\"github\" target=\"blank\" href=\"https://github.com/Brunomachadob/smart-game-discounts\">\n            <GitHubIcon />\n          </IconButton>\n        </Toolbar>\n      </AppBar>\n      <div className={classes.root}>\n        <Typography color=\"textSecondary\">\n          This is a small toy application showcasing a fidelity program that studios would apply on a \n          market place (Steam for example) that would give discounts based on games the user already have in their library.\n        </Typography>\n        <Rules rules={RULES}></Rules>\n        <Store games={storeGames} onBuyGame={onBuyGame} />\n        <Library games={libraryGames} onRemoveGame={onRemoveLibraryGame} />\n      </div>\n    </div>\n  );\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}